---
- hosts: lib
  tasks:
    - name: lint
      command:
        cmd: >
          mvn
          {% if is_local_building %}
          spotless:apply
          {% else %}
          spotless:check
          --settings ../settings.xml
          --activate-profiles ci
          --define github.actor={{ github_actor }}
          --define github.token={{ github_token }}
          {% endif %}
          --batch-mode
        chdir: ../libs
        strip_empty_ends: false
      changed_when: false

- hosts: app
  tasks:
    - name: lint
      command:
        cmd: >
          mvn
          {% if is_local_building %}
          spotless:apply
          {% else %}
          spotless:check
          --settings ../settings.xml
          --activate-profiles ci
          --define github.actor={{ github_actor }}
          --define github.token={{ github_token }}
          {% endif %}
          --batch-mode
        chdir: ../apps
        strip_empty_ends: false
      changed_when: false
