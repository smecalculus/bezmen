version: '3'

vars:
  PROJECT: bezmen
  REGISTRY: localhost
  PROJECT_REPO: '{{.REGISTRY}}/smecalculus'
  USAGE: '{{.USAGE | default "toy"}}'
  PROPS: '{{.PROPS | default "turing"}}'
  GIT_ADD_ALL:
    sh: git add -A
  ENV_DB_VENDOR: postgres

includes:
  lib:
    taskfile: libs/Taskfile.yml
    dir: libs
  env:
    taskfile: env/Taskfile.yml
    dir: env
  app:
    taskfile: apps/Taskfile.yml
    dir: apps
  stand:
    taskfile: stands/Taskfile.yml
    dir: stands
  test:
    taskfile: tests/Taskfile.yml
    dir: tests
  stage:
    taskfile: stages/Taskfile.yml
    dir: stages

tasks:
  clean:
    cmds:
      - docker image prune -f
      - docker volume rm $(docker volume ls -q -f dangling=true)
      - docker network prune -f
