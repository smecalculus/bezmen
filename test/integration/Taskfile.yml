version: '3'

set: [pipefail]

vars:
  TEST_INTEGRATION_REVISION:
    sh: git write-tree --prefix=test/integration
  TEST_INTEGRATION_REV: '{{.TEST_INTEGRATION_REVISION | trunc 7 }}'

tasks:
  run:
    deps:
      - task: ::app:binary
    cmds:
      - cmd: >
          mvn test
